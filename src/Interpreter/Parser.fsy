%{

let getOp (op:string) = 
  match op with 
  | "+" -> (+)
  | _ -> failwith "oh noes!"

%}

%token <int> Int
%token <string> OP

%token LPAREN 
%token RPAREN

%token EOF

%start main
%type <int> main
%%

main:
	expr EOF				{ $1 }

expr: Int					{ $1 }
	| LPAREN expr RPAREN	{ $2 }
	| OP expr expr			{ (getOp $1) $2  $3 }